# Headers de sécurité HTTPS
Header always set Strict-Transport-Security "max-age=31536000; includeSubDomains; preload" env=HTTPS
Header always set X-Content-Type-Options "nosniff"
#Header always set X-Frame-Options "DENY"
# Protection contre le clickjacking
Header always set X-Frame-Options "SAMEORIGIN"
# Protection XSS
Header always set X-XSS-Protection "1; mode=block"
# Politique de référent
Header always set Referrer-Policy "strict-origin-when-cross-origin"

# Activer le moteur de réécriture d'URL
RewriteEngine On

# Forcer HTTPS - Méthode robuste pour tous les hébergeurs
# Vérifier si la connexion n'est PAS en HTTPS
RewriteCond %{HTTPS} !=on [OR]
RewriteCond %{HTTP:X-Forwarded-Proto} !https [OR]
RewriteCond %{SERVER_PORT} 80

# Rediriger tout le trafic HTTP vers HTTPS avec code 301 (permanent)
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]


# Facultatif : forcer www (décommente si tu veux que ton site s'ouvre toujours avec www)
# RewriteCond %{HTTP_HOST} !^www\. [NC]
# RewriteRule ^(.*)$ https://www.%{HTTP_HOST}/$1 [L,R=301]